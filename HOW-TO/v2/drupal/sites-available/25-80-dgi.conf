<VirtualHost *:80>
  ServerName ${DRUPAL_IP}

  ## Vhost docroot
  DocumentRoot "/opt/www/drupal"

  ## Directories, there should at least be a declaration for /opt/www/drupal

  <Directory "/opt/www/drupal">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Require all granted
  </Directory>

  <Location "/iiif/2">
    Require all granted
    <If "-z %{HTTP:X-Forwarded-Proto}">
    RequestHeader set X-Forwarded-Proto expr=%{REQUEST_SCHEME}
    </If>
    RequestHeader set X-Forwarded-Path /
    ProxyPass http://cantaloupe:8080/cantaloupe/iiif/2
    ProxyPassReverse http://cantaloupe:8080/cantaloupe/iiif/2

  </Location>

  ## Logging
  ErrorLog "/var/log/apache2/.log"
  ServerSignature Off
  CustomLog "/var/log/apache2/.log" combined
  ## Rewrite rules
  RewriteEngine On

  #Redirect to HTTPS endpoint. leave commented out on test boxes
#RewriteCond %{ENV:DGI_SSL_DO_REDIRECT_TO_SSL} !=false
#RewriteCond %{REQUEST_URI} !\.well-known/acme-challenge
#RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]


  ## Server aliases
  ServerAlias localhost
</VirtualHost>
